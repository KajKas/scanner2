<!DOCTYPE html>
<html>
<head>
</head>
<body>
    <!-- content -->
    <form>
        <div>
            <label>pracownik</label>
            <input id="employee-id" type="text"/>
            <button onclick="scanBarcode()">Zaloguj pracownika</button>
        </div>
        <div>
            <label>salon</label>
            <input id="salon-id" type="text"/>
            <button>Zaloguj salon</button>
        </div>
    </form>

    <section id="container" class="container">
        <div id="result_strip">
            <ul class="thumbnails"></ul>
        </div>
        <div id="interactive" class="viewport"></div>
    </section>

    <!-- dependencies -->
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="quagga.js" type="text/javascript"></script>

    <!-- code -->
    <script type="text/javascript">
        var employeeId = document.getElementById('employee-id');
        var code;
        function scanBarcode() {        
            Quagga.init({
                inputStream : {
                name : "Live",
                type : "LiveStream"
                },
                decoder : {
                readers : ["ean_reader"]
                }
            }, function(err) {
                if (err) {
                    console.log(err);
                    return
                }
                console.log("Initialization finished. Ready to start");
                Quagga.start();
            });

                Quagga.onDetected(function(result) {
                    code = result.codeResult.code;

                    if (Quagga.lastResult !== code) {
                        Quagga.lastResult = code;
                        var $node = null, canvas = Quagga.canvas.dom.image;
                        $node = $('<div class="thumbnail"><div class="imgWrapper"><img /></div><div class="caption"><h4 class="code"></h4></div></div>');
                        $node.find("img").attr("src", canvas.toDataURL());
                        $("#result_strip ul.thumbnails").prepend($node);
                        Quagga.stop();
                        document.getElementById('interactive').style.display = 'none';
                        employeeId.value = code;
                    }
                });
        }
    </script>
</body>
</html>
